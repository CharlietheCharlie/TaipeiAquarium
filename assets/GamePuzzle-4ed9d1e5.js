import{_ as z,a as W}from"./crownshark-d1287b92.js";import{_ as H,q as Y,a as X,o as U,c as V,d as L,b as Z,w as j,F as J,l as $,p as K,j as Q}from"./index-44d585a9.js";function ee(){let m;const D=Math.random,k=Math.floor,R=Math.hypot;function N(){return location.pathname.includes("/fullcpgrid/")}function i(e,t){return typeof t>"u"?e*D():e+(t-e)*D()}function h(e,t){return typeof t>"u"&&(t=e,e=0),k(e+(t-e)*D())}function p(e){let t,s;for(let a=e.length-1;a>=1;--a)t=Math.floor((a+1)*Math.random()),s=e[a],e[a]=e[t],e[t]=s;return e}function d(e){let t=e.parentDiv;typeof t=="string"&&(t=document.getElementById(t));let s=document.createElement("div");s.setAttribute("id",e.idDivMenu);let a=document.createElement("div");a.classList.add("title"),a.appendChild(document.createTextNode(e.title));let o=this;a.addEventListener("click",()=>o.display()),s.appendChild(a),this.list=[];for(let n=0;n<e.lines.length;++n)a=document.createElement("div"),a.classList.add("line"),a.appendChild(document.createTextNode(e.lines[n].text)),a.style.top=e.lineOffset+n*e.lineStep+"px",a.addEventListener("click",e.lines[n].func),s.appendChild(a),this.list.push(a);s.style.height=e.lineOffset+e.lines.length*e.lineStep+"px",this.divMenu=s,t.appendChild(s)}d.prototype.collapse=function(){this.divMenu.classList.remove("open")},d.prototype.display=function(){this.divMenu.classList.add("open")};function l(e,t){this.x=Number(e),this.y=Number(t)}l.prototype.copy=function(){return new l(this.x,this.y)};function y(e,t){this.p1=new l(e.x,e.y),this.p2=new l(t.x,t.y)}y.prototype.length=function(){var e=this.p1.x-this.p2.x,t=this.p1.y-this.p2.y;return R(e,t)},y.prototype.dx=function(){return this.p2.x-this.p1.x},y.prototype.dy=function(){return this.p2.y-this.p1.y},y.prototype.pointOnRelative=function(e){var t=this.p2.x-this.p1.x,s=this.p2.y-this.p1.y;return new l(this.p1.x+e*t,this.p1.y+e*s)};let g;{let a=function(){if(this.files.length==0){o({fail:"no file"});return}let n=this.files[0],r=new FileReader;r.addEventListener("load",()=>{e.image&&(e.image.src=r.result),o({success:r.result,file:n})}),r.addEventListener("abort",()=>{o({fail:"abort"})}),r.addEventListener("error",()=>{o({fail:"error"})}),e.image||e.readMethod=="readAsDataURL"?r.readAsDataURL(this.files[0]):r.readAsText(this.files[0])},o=function(n){t(n)},e,t,s=document.createElement("input");s.setAttribute("type","file"),s.style.display="none",s.addEventListener("change",a),g=function(n,r){e=r,t=n,e.accept?s.setAttribute("accept",e.accept):s.removeAttribute("accept"),s.click()}}function G(){this.type="",this.points=[]}G.prototype.twist=function(e,t,s,a){const o=new y(this.points[0],this.points[1]),n=o.dx(),r=o.dy(),u=new y(e,t),c=o.pointOnRelative(.5),w=u.pointOnRelative(.5),P=new y(c,w),x=P.dx(),b=P.dy(),_=F(5/12,1/12),M=F(4/12,3/12),E=F(1/2,4/12),v=F(1-4/12,3/12),A=F(1-5/12,1/12);this.points=[o.p1,new l(o.p1.x+5/12*n*.52,o.p1.y+5/12*r*.52),new l(_.x-1/12*x*.72,_.y-1/12*b*.72),_,new l(_.x+1/12*x*.72,_.y+1/12*b*.72),new l(M.x-1/12*x*.72,M.y-1/12*b*.72),M,new l(M.x+1/12*x*.52,M.y+1/12*b*.52),new l(E.x-2/12*n*.52*s,E.y-2/12*r*.52*a),E,new l(E.x+2/12*n*.52*s,E.y+2/12*r*.52*a),new l(v.x+1/12*x*.52,v.y+1/12*b*.52),v,new l(v.x-1/12*x*.72,v.y-1/12*b*.72),new l(A.x+1/12*x*.72,A.y+1/12*b*.72),A,new l(A.x-1/12*x*.72,A.y-1/12*b*.72),new l(o.p2.x-5/12*n*.52,o.p2.y-5/12*r*.52),o.p2],this.type="z";function F(q,O){return new l(o.p1.x+q*n+O*x,o.p1.y+q*r+O*b)}},G.prototype.drawPath=function(e,t,s,a,o){let n;if(a)if(o||e.moveTo(this.points[this.points.length-1].x-t,this.points[this.points.length-1].y-s),this.type=="d")e.lineTo(this.points[0].x-t,this.points[0].y-s);else for(n=this.points.length-2;n>0;n-=3)e.bezierCurveTo(this.points[n].x-t,this.points[n].y-s,this.points[n-1].x-t,this.points[n-1].y-s,this.points[n-2].x-t,this.points[n-2].y-s);else if(o||e.moveTo(this.points[0].x-t,this.points[0].y-s),this.type=="d")e.lineTo(this.points[1].x-t,this.points[1].y-s);else for(n=1;n<this.points.length-1;n+=3)e.bezierCurveTo(this.points[n].x-t,this.points[n].y-s,this.points[n+1].x-t,this.points[n+1].y-s,this.points[n+2].x-t,this.points[n+2].y-s)};function I(e,t){this.ts=new G,this.rs=new G,this.bs=new G,this.ls=new G,this.kx=e,this.ky=t}I.prototype.drawPath=function(e,t,s,a){a!==!0&&e.beginPath(),this.ts.drawPath(e,t,s,!1,!1),this.rs.drawPath(e,t,s,!1,!0),this.bs.drawPath(e,t,s,!0,!0),this.ls.drawPath(e,t,s,!0,!0)},I.prototype.createDivPiece=function(e,t,s,a){let o,n,r;this.theDiv=document.createElement("div"),this.theDiv.style.width=3*e.dx+"px",this.theDiv.style.height=3*e.dy+"px",this.theDiv.style.position="absolute",this.theCanv=document.createElement("canvas"),this.theCanv.width=3*e.dx,this.theCanv.height=3*e.dy,n=e.dx*(this.kx-1),r=e.dy*(this.ky-1),o=this.ctx=this.theCanv.getContext("2d"),this.drawPath(o,n,r),o.clip();let u,c,w,P,x,b,_,M;this.kx==0?(u=0*e.dx/t+s,_=2*e.dx,x=e.dx):(u=(this.kx-1)*e.dx/t+s,_=3*e.dx,x=0),w=_/t,this.ky==0?(c=0*e.dy/t+a,M=2*e.dy,b=e.dy):(c=(this.ky-1)*e.dy/t+a,M=3*e.dy,b=0),P=M/t,o.drawImage(e.image,u,c,w,P,x,b,_,M);let E=1,v=2;return e.dx>100&&e.dy>100?(E=2,v=5):e.dx>50&&e.dy>50&&(E=1.5,v=3),this.drawPath(o,n+E,r+E),o.lineWidth=v,o.strokeStyle="rgba(0, 0, 0, 0.3)",o.stroke(),this.drawPath(o,n-E,r-E),o.lineWidth=v,o.strokeStyle="rgba(255, 255, 255, 0.3)",o.stroke(),this.drawPath(o,n,r),this.moveTo(new l((this.kx-1)*e.dx+f.MARGIN1,(this.ky-1)*e.dy+f.MARGIN1)),this.theDiv.appendChild(this.theCanv),this.theDiv},I.prototype.where=function(){let e,t;return e=parseFloat(this.theDiv.style.left),t=parseFloat(this.theDiv.style.top),new l(e,t)},I.prototype.moveTo=function(e){this.theDiv.style.top=e.y+"px",this.theDiv.style.left=e.x+"px"},I.prototype.insidePiece=function(e,t){let s=getComputedStyle(this.theDiv),a=e-parseFloat(s.left),o=t-parseFloat(s.top);return this.ctx.isPointInPath(a,o)};function B(e,t){this.pckxmin=this.pckxmax=this.pckymin=this.pckymax=e,this.pieces=[e],this.puzzle=t}B.prototype.merge=function(e){for(let t=0;t<e.pieces.length;++t)this.pieces.push(e.pieces[t]),e.pieces[t].kx<this.pckxmin.kx&&(this.pckxmin=e.pieces[t]),e.pieces[t].kx>this.pckxmax.kx&&(this.pckxmax=e.pieces[t]),e.pieces[t].ky<this.pckymin.ky&&(this.pckymin=e.pieces[t]),e.pieces[t].ky>this.pckymax.ky&&(this.pckymax=e.pieces[t]);this.moveTo(this.where()),this.pieces.sort(function(t,s){return t.ky<s.ky?-1:t.ky>s.ky?1:t.kx<s.kx?-1:t.kx>s.kx?1:0})},B.prototype.where=function(){return this.pieces[0].where()},B.prototype.moveTo=function(e){this.pieces[0].moveTo(e);for(let t=1;t<this.pieces.length;++t)this.pieces[t].moveTo(new l(e.x+this.puzzle.dx*(this.pieces[t].kx-this.pieces[0].kx),e.y+this.puzzle.dy*(this.pieces[t].ky-this.pieces[0].ky)))},B.prototype.ifNear=function(e){let t,s;for(let a=0;a<this.pieces.length;++a){t=this.pieces[a];for(let o=0;o<e.pieces.length;++o)if(s=e.pieces[o],t.kx==s.kx&&t.ky==s.ky+1&&this.puzzle.near(t,s,0,-1)||t.kx==s.kx&&t.ky==s.ky-1&&this.puzzle.near(t,s,0,1)||t.kx-1==s.kx&&t.ky==s.ky&&this.puzzle.near(t,s,-1,0)||t.kx+1==s.kx&&t.ky==s.ky&&this.puzzle.near(t,s,1,0))return!0}return!1};function f(e){typeof e.img=="string"?(this.image=new Image,this.image.src=e.img,this.image.addEventListener("load",function(t){return function(){t.createPuzzle(e)}}(this))):(this.image=e.img,this.createPuzzle(e))}f.MARGIN1=5,f.prototype.createPuzzle=function(e){let t=this.image.width,s=this.image.height;this.reqHeight=e.height,this.reqWidth=e.width,this.height=this.reqHeight-2*f.MARGIN1,this.width=this.reqWidth-2*f.MARGIN1,t/s>this.width/this.height?this.height=this.width*s/t:this.width=this.height*t/s,typeof e.idiv=="string"?this.divGame=document.getElementById(e.idiv):this.divGame=e.idiv,this.divGame.style.overflow="visible",this.divGame.style.position="relative",this.divBoard||(this.divBoard=document.createElement("div"),this.divGame.appendChild(this.divBoard)),this.divBoard.style.overflow="hidden",this.divBoard.style.position="absolute",this.divBoard.style.left=0,this.divBoard.style.top=0,this.listeners=[],this.divGame.style.width=this.divBoard.style.width=this.width+2*f.MARGIN1+"px",this.divGame.style.height=this.divBoard.style.height=this.height+2*f.MARGIN1+"px",this.canvMobile||(this.canvMobile=document.createElement("canvas"),this.divBoard.appendChild(this.canvMobile)),this.canvMobile.style.visibility="visible",this.canvMobile.width=parseFloat(this.divBoard.style.width),this.canvMobile.height=parseFloat(this.divBoard.style.height),this.canvMobile.style.position="absolute",this.canvMobile.style.top="0px",this.canvMobile.style.left="0px",this.canvMobile.style.zIndex=5e4,this.dCoupling=10,this.canvMobile.getContext("2d").drawImage(this.image,0,0,t,s,f.MARGIN1,f.MARGIN1,this.width,this.height),this.menu||(this.menu=new d({parentDiv:this.divGame,idDivMenu:"divmenu",title:"選擇拼圖片數",lineOffset:65,lineStep:45,lines:[{text:"12 片",func:this.returnFunct(12)},{text:"25 片",func:this.returnFunct(25)},{text:"很多片",func:this.returnFunct(200)}]})),m&&(this.npieces=25,this.next())},f.prototype.returnFunct=function(e){let t=this;return function(){t.menu.collapse(),t.npieces=e,t.next()}},f.prototype.loadImage=function(){let e=this;return function(){e.menu.collapse(),g(()=>{},{accept:"image/*",readMethod:"readAsDataURL",image:e.image})}},f.prototype.next=function(){let e,t,s,a,o,n,r,u=.12;for(this.canvMobile.style.visibility="hidden",this.computenxAndny(),e=this.nx,t=this.ny,this.image.width/this.image.height<(this.reqWidth-2*f.MARGIN1)/(this.reqHeight-2*f.MARGIN1)?(this.width=(this.reqWidth-2*f.MARGIN1)/(e+2)*e,this.height=this.width/this.image.width*this.image.height,this.height>this.reqHeight-2*f.MARGIN1&&(this.height=this.reqHeight-2*f.MARGIN1,this.width=this.height*this.image.width/this.image.height),this.freeSpace=0):(this.height=(this.reqHeight-2*f.MARGIN1)/(t+2)*t,this.width=this.height/this.image.height*this.image.width,this.width>this.reqWidth-2*f.MARGIN1&&(this.width=this.reqWidth-2*f.MARGIN1,this.height=this.width*this.image.height/this.image.width),this.freeSpace=1),this.height,this.width,this.dx=a=this.width/e,this.dy=o=this.height/t,this.dCoupling=Math.max(10,Math.min(a,o)/10);this.divBoard.firstChild;)this.divBoard.removeChild(this.divBoard.firstChild);this.divBoard.appendChild(this.canvMobile),this.canvMobile.width=this.reqWidth,this.divGame.style.width=this.divBoard.style.width=this.canvMobile.width+"px",this.canvMobile.height=this.reqHeight,this.divGame.style.height=this.divBoard.style.height=this.canvMobile.height+"px";let c=[];for(r=0;r<=t;++r)for(c[r]=[],n=0;n<=e;++n)c[r][n]=new l((n+i(-u,u))*a,(r+i(-u,u))*o),n==0&&(c[r][n].x=0),n==e&&(c[r][n].x=this.width),r==0&&(c[r][n].y=0),r==t&&(c[r][n].y=this.height);for(this.pieces=[],r=0;r<t;++r)for(this.pieces[r]=[],n=0;n<e;++n)this.pieces[r][n]=s=new I(n,r),r==0?(s.ts.points=[c[r][n],c[r][n+1]],s.ts.type="d"):s.ts=this.pieces[r-1][n].bs,s.rs.points=[c[r][n+1],c[r+1][n+1]],s.rs.type="d",n<e-1&&(h(2)?s.rs.twist(c[r][n],c[r+1][n],.5,1):s.rs.twist(c[r][n+2],c[r+1][n+2],.5,1)),n==0?(s.ls.points=[c[r][n],c[r+1][n]],s.ls.type="d"):s.ls=this.pieces[r][n-1].rs,s.bs.points=[c[r+1][n],c[r+1][n+1]],s.bs.type="d",r<t-1&&(h(2)?s.bs.twist(c[r][n],c[r][n+1],1,.5):s.bs.twist(c[r+2][n],c[r+2][n+1],1,.5));this.associateImage()},f.prototype.associateImage=function(){let e,t,s,a,o,n,r,u,c,w;for(r=this.image.width,n=this.image.height,r/n>this.width/this.height?(o=this.height/n,c=0,u=(r-this.width/o)/2):(o=this.width/r,u=0,c=(n-this.height/o)/2),this.mech={scale:o,offsx:u,offsy:c},this.polyPieces=[],t=0;t<this.ny;t++)for(e=0;e<this.nx;e++)this.pieces[t][e].createDivPiece(this,o,u,c),this.polyPieces.push(new B(this.pieces[t][e],this));for(p(this.polyPieces),this.evaluateZIndex(),a=0;a<this.polyPieces.length;a++)for(s=0;s<this.polyPieces[a].pieces.length;s++)switch(w=this.polyPieces[a].pieces[s],this.divBoard.appendChild(w.theDiv),this.freeSpace){case 0:w.pTarget=new l(this.reqWidth-(2.25+Math.random()/4)*this.dx,Math.random()*(this.height-this.dy)-this.dy);break;case 1:w.pTarget=new l(Math.random()*(this.width-this.dx)-this.dx,this.reqHeight-(2.25+Math.random()/4)*this.dy)}window.setTimeout(function(P){return function(){P.launchAnimation()}}(this),1e3)},f.prototype.addRemovableEventListener=function(e,t){this.divBoard.addEventListener(e,t),this.listeners.push({event:e,funct:t})},f.prototype.removeAllListeners=function(){let e;for(;this.listeners.length>0;)e=this.listeners.pop(),this.divBoard.removeEventListener(e.event,e.funct)},f.prototype.launchAnimation=function(){this.anim={cpt:m?200:100},this.anim.tmr=window.setInterval(function(e){return function(){e.animate()}}(this),20)},f.prototype.animate=function(){let e,t,s,a,o;if(this.anim.cpt==0){window.clearInterval(this.anim.tmr),delete this.anim,this.evaluateZIndex(),this.beginGame();return}for(this.anim.cpt--,e=0;e<this.polyPieces.length;e++)for(t=0;t<this.polyPieces[e].pieces.length;t++)s=this.polyPieces[e].pieces[t],a=s.where(),o=s.pTarget,s.moveTo(new l((this.anim.cpt*a.x+o.x)/(this.anim.cpt+1),(this.anim.cpt*a.y+o.y)/(this.anim.cpt+1))),this.anim.cpt==0&&delete s.pTarget},f.prototype.animateEnd=function(){let e,t;if(this.anim.cpt==0){window.clearInterval(this.anim.tmr),delete this.anim;return}this.anim.cpt--,e=parseFloat(this.canvMobile.style.left),t=parseFloat(this.canvMobile.style.top),this.canvMobile.style.left=(this.anim.cpt*e+this.anim.xfin)/(this.anim.cpt+1)+"px",this.canvMobile.style.top=(this.anim.cpt*t+this.anim.yfin)/(this.anim.cpt+1)+"px"},f.prototype.merge=function(e,t){let s,a,o;for(this.polyPieces[e].merge(this.polyPieces[t]),s=this.polyPieces[e],e>t?(this.polyPieces.splice(e,1),this.polyPieces.splice(t,1)):(this.polyPieces.splice(t,1),this.polyPieces.splice(e,1)),a=s.pieces.length,o=0;o<this.polyPieces.length&&this.polyPieces[o].pieces.length>=a;o++);return this.polyPieces.splice(o,0,s),o},f.prototype.evaluateZIndex=function(){let e,t,s;for(s=1,e=0;e<this.polyPieces.length;e++)for(t=0;t<this.polyPieces[e].pieces.length;t++)this.polyPieces[e].pieces[t].theDiv.style.zIndex=s++},f.prototype.beginGame=function(){let e=getComputedStyle(this.divGame);this.mouseOffsX=this.divGame.offsetLeft+parseFloat(e.borderLeftWidth),this.mouseOffsY=this.divGame.offsetTop+parseFloat(e.borderTopWidth),this.pieceMove=!1,this.addRemovableEventListener("mousedown",function(t){return function(s){s.preventDefault();let[a,o]=[s.clientX,s.clientY],n={x:a,y:o,buttons:s.buttons,origin:"mouse"};t.mouseDownGame(n)}}(this)),this.addRemovableEventListener("mouseup",function(t){return function(s){s.preventDefault();let[a,o]=[s.clientX,s.clientY],n={x:a,y:o,buttons:s.buttons,origin:"mouse"};t.mouseUpGame(n)}}(this)),this.addRemovableEventListener("mousemove",function(t){return function(s){s.preventDefault();let[a,o]=[s.clientX,s.clientY],n={x:a,y:o,buttons:s.buttons,origin:"mouse"};t.mouseMoveGame(n)}}(this)),this.addRemovableEventListener("touchstart",function(t){return function(s){if(s.preventDefault(),s.touches.length!=1)return;let[a,o]=[s.touches[0].clientX,s.touches[0].clientY],n={x:a,y:o,buttons:null,origin:"touch"};t.mouseDownGame(n)}}(this)),this.addRemovableEventListener("touchend",function(t){return function(s){s.preventDefault();let a={origin:"touch"};t.mouseUpGame(a)}}(this)),this.addRemovableEventListener("touchcancel",function(t){return function(s){s.preventDefault();let a={origin:"touch"};t.mouseUpGame(a)}}(this)),this.addRemovableEventListener("touchmove",function(t){return function(s){if(s.preventDefault(),s.touches.length!=1)return;let[a,o]=[s.touches[0].clientX,s.touches[0].clientY],n={x:a,y:o,buttons:null,origin:"touch"};t.mouseMoveGame(n)}}(this))},f.prototype.mouseDownGame=function(e){e.origin=="mouse"&&e.buttons!=1||(this.pieceMove=this.lookForPiece(e),this.pieceMove!==!1&&(this.emphasize(this.pieceMove.pp),this.pieceMove.offsx=e.x-this.mouseOffsX-parseFloat(this.canvMobile.style.left),this.pieceMove.offsy=e.y-this.mouseOffsY-parseFloat(this.canvMobile.style.top),this.divGame.style.cursor="move"))},f.prototype.mouseUpGame=function(e){let t,s,a;if(this.divGame.style.cursor="default",this.pieceMove===!1)return;let o=parseFloat(this.canvMobile.style.left),n=parseFloat(this.canvMobile.style.top);for(this.canvMobile.getContext("2d").clearRect(0,0,this.canvMobile.width,this.canvMobile.height),s=this.polyPieces[this.pieceMove.pp],t=0;t<s.pieces.length;t++)a=s.pieces[t],a.moveTo(new l(this.dx*(a.kx-1)+o,this.dy*(a.ky-1)+n)),a.theDiv.style.visibility="visible";let r=this.pieceMove.pp,u=!1,c=!1;do for(u=!1,s=this.polyPieces[r],t=0;t<this.polyPieces.length;t++)if(t!==r&&s.ifNear(this.polyPieces[t])){r=this.merge(t,r),u=!0,c=!0;break}while(u);if(!c){let x=this.polyPieces[r];for(this.polyPieces.splice(r,1),t=r;t<this.polyPieces.length&&this.polyPieces[t].pieces.length>=x.pieces.length;t++);this.polyPieces.splice(t,0,x)}if(this.evaluateZIndex(),this.pieceMove=!1,this.polyPieces.length>1)return;for(this.removeAllListeners(),this.canvMobile.getContext("2d").drawImage(this.image,this.mech.offsx,this.mech.offsy,this.width/this.mech.scale,this.height/this.mech.scale,0,0,this.width,this.height),this.anim={cpt:100,xorg:0,yorg:0,xfin:(this.reqWidth-this.dx*this.nx)/2,yfin:(this.reqHeight-this.dy*this.ny)/2},this.anim.xorg=parseFloat(this.polyPieces[0].pieces[0].theDiv.style.left)+this.dx,this.anim.yorg=parseFloat(this.polyPieces[0].pieces[0].theDiv.style.top)+this.dy,this.canvMobile.style.left=this.anim.xorg+"px",this.canvMobile.style.top=this.anim.yorg+"px",t=0;t<this.polyPieces[0].pieces.length;t++)this.polyPieces[0].pieces[t].theDiv.style.visibility="hidden";let P=Math.sqrt((this.anim.xorg-this.anim.xfin)*(this.anim.xorg-this.anim.xfin)+(this.anim.yorg-this.anim.yfin)*(this.anim.yorg-this.anim.yfin));this.anim.cpt=P/2,this.anim.cpt<12&&(this.anim.cpt=12),this.anim.cpt>100&&(this.anim.cpt=100),this.anim.cpt=Math.floor(this.anim.cpt),this.anim.tmr=window.setInterval(function(x){return function(){var b=document.querySelector(".lightbox"),_=document.querySelector(".close");_.addEventListener("click",function(){b.style.display="none"}),b&&(b.style.display="block"),x.animateEnd()}}(this),20)},f.prototype.mouseMoveGame=function(e){if(this.pieceMove===!1)return;if(e.origin=="mouse"&&!(e.buttons&1)){this.mouseUpGame(e);return}let t=e.x-this.mouseOffsX,s=e.y-this.mouseOffsY;t<2&&(t=2),t>Math.floor(parseFloat(this.divBoard.style.width))-2&&(t=Math.floor(parseFloat(this.divBoard.style.width))-2),s<2&&(s=2),s>Math.floor(parseFloat(this.divBoard.style.height))-2&&(s=Math.floor(parseFloat(this.divBoard.style.height))-2),this.canvMobile.style.left=t-this.pieceMove.offsx+"px",this.canvMobile.style.top=s-this.pieceMove.offsy+"px"},f.prototype.lookForPiece=function(e){let t,s,a=e.x-this.mouseOffsX,o=e.y-this.mouseOffsY;for(t=this.polyPieces.length-1;t>=0;t--)for(s=this.polyPieces[t].pieces.length-1;s>=0;s--)if(this.polyPieces[t].pieces[s].insidePiece(a,o))return{pp:t,pc:s};return!1},f.prototype.emphasize=function(e){let t,s,a,o=this.polyPieces[e],n=this.canvMobile.getContext("2d"),r=S(o.pieces),u;for(n.save(),n.clearRect(0,0,this.canvMobile.width,this.canvMobile.height),n.beginPath(),t=0;t<r.length;t++)for(s=0;s<r[t].length;s++)switch(u=r[t][s],u.edge){case 0:o.pieces[u.kp].ts.drawPath(n,0,0,!1,s!=0);break;case 1:o.pieces[u.kp].rs.drawPath(n,0,0,!1,s!=0);break;case 2:o.pieces[u.kp].bs.drawPath(n,0,0,!0,s!=0);break;case 3:o.pieces[u.kp].ls.drawPath(n,0,0,!0,s!=0);break}for(n.fillStyle="none",n.shadowColor="rgba(0, 0, 0, 0.5)",n.shadowBlur=4,n.shadowOffsetX=4,n.shadowOffsetY=4,n.fill(),n.clip("evenodd"),n.shadowColor="rgba(0, 0, 0, 0)",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0,n.drawImage(this.image,this.mech.offsx,this.mech.offsy,this.width/this.mech.scale,this.height/this.mech.scale,0,0,this.width,this.height),a=0;a<o.pieces.length;a++)o.pieces[a].theDiv.style.visibility="hidden";n.restore(),this.canvMobile.style.left=o.pieces[0].where().x-(o.pieces[0].kx-1)*this.dx+"px",this.canvMobile.style.top=o.pieces[0].where().y-(o.pieces[0].ky-1)*this.dy+"px",this.canvMobile.style.visibility="visible"},f.prototype.near=function(e,t,s,a){let o=e.where(),n=t.where();return!(Math.abs(o.x-n.x+s*this.dx)>this.dCoupling||Math.abs(o.y-n.y+a*this.dy)>this.dCoupling)},f.prototype.computenxAndny=function(){let e,t,s=this.image.width,a=this.image.height,o=this.npieces,n,r=1e9,u,c,w=Math.round(Math.sqrt(o*s/a)),P=Math.round(o/w);for(t=0;t<5;t++)for(u=P+t-2,e=0;e<5;e++)c=w+e-2,n=c*a/u/s,n=n+1/n-2,n+=Math.abs(1-c*u/o),n<r&&(r=n,this.nx=c,this.ny=u)};function S(e){function t(_,M,E){let v;switch(E){case 0:M--;break;case 1:_++;break;case 2:M++;break;case 3:_--;break}for(v=0;v<e.length;v++)if(_==e[v].kx&&M==e[v].ky)return!0;return!1}function s(_,M,E){let v;for(v=0;v<o.length;v++)if(_==o[v].kx&&M==o[v].ky&&E==o[v].edge)return v;return!1}let a=[],o=[],n,r,u,c,w,P,x,b=[[{dkx:0,dky:0,edge:1},{dkx:1,dky:0,edge:0},{dkx:1,dky:-1,edge:3}],[{dkx:0,dky:0,edge:2},{dkx:0,dky:1,edge:1},{dkx:1,dky:1,edge:0}],[{dkx:0,dky:0,edge:3},{dkx:-1,dky:0,edge:2},{dkx:-1,dky:1,edge:1}],[{dkx:0,dky:0,edge:0},{dkx:0,dky:-1,edge:3},{dkx:-1,dky:-1,edge:2}]];for(n=0;n<e.length;n++)for(r=0;r<4;r++)t(e[n].kx,e[n].ky,r)||o.push({kx:e[n].kx,ky:e[n].ky,edge:r,kp:n});for(;o.length>0;){u=[],c=o[0],u.push(c),o.splice(0,1);do{for(w=0;w<3;w++)if(x=b[c.edge][w],P=s(c.kx+x.dkx,c.ky+x.dky,x.edge),P!==!1){c=o[P],u.push(c),o.splice(P,1);break}if(P===!1)break}while(1);a.push(u)}return a}let C="../img/puzzle_seahorse.png";m=N(),new f({img:C,width:window.innerWidth-150,height:window.innerHeight-150,idiv:"forPuzzle"})}/*!
 * A lightweight, dependency-free and responsive javascript plugin for particle backgrounds.
 *
 * @author Marc Bruederlin <hello@marcbruederlin.com>
 * @version 2.2.3
 * @license MIT
 * @see https://github.com/marcbruederlin/particles.js
 */function te(){(function(m,D){var k,R={};function N(i,h){return i.x<h.x?-1:i.x>h.x?1:i.y<h.y?-1:i.y>h.y?1:0}return k=function(){function i(){var h=this;h.defaults={responsive:null,selector:null,maxParticles:100,sizeVariations:3,showParticles:!0,speed:.5,color:"#000000",minDistance:120,connectParticles:!1},h.element=null,h.context=null,h.ratio=null,h.breakpoints=[],h.activeBreakpoint=null,h.breakpointSettings=[],h.originalSettings=null,h.storage=[],h.usingPolyfill=!1}return i}(),k.prototype.init=function(i){var h=this;return h.options=h._extend(h.defaults,i),h.originalSettings=JSON.parse(JSON.stringify(h.options)),h._animate=h._animate.bind(h),h._initializeCanvas(),h._initializeEvents(),h._registerBreakpoints(),h._checkResponsive(),h._initializeStorage(),h._animate(),h},k.prototype.destroy=function(){var i=this;i.storage=[],i.element.remove(),m.removeEventListener("resize",i.listener,!1),m.clearTimeout(i._animation),cancelAnimationFrame(i._animation)},k.prototype._initializeCanvas=function(){var i=this,h,p;if(!i.options.selector)return console.warn("particles.js: No selector specified! Check https://github.com/marcbruederlin/particles.js#options"),!1;i.element=D.querySelector(i.options.selector),i.context=i.element.getContext("2d"),h=m.devicePixelRatio||1,p=i.context.webkitBackingStorePixelRatio||i.context.mozBackingStorePixelRatio||i.context.msBackingStorePixelRatio||i.context.oBackingStorePixelRatio||i.context.backingStorePixelRatio||1,i.ratio=h/p,i.element.width=i.element.offsetParent?i.element.offsetParent.clientWidth*i.ratio:i.element.clientWidth*i.ratio,i.element.offsetParent&&i.element.offsetParent.nodeName==="BODY"?i.element.height=m.innerHeight*i.ratio:i.element.height=i.element.offsetParent?i.element.offsetParent.clientHeight*i.ratio:i.element.clientHeight*i.ratio,i.element.style.width="100%",i.element.style.height="100%",i.context.scale(i.ratio,i.ratio)},k.prototype._initializeEvents=function(){var i=this;i.listener=function(){i._resize()}.bind(this),m.addEventListener("resize",i.listener,!1)},k.prototype._initializeStorage=function(){var i=this;i.storage=[];for(var h=i.options.maxParticles;h--;)i.storage.push(new R(i.context,i.options))},k.prototype._registerBreakpoints=function(){var i=this,h,p,d,l=i.options.responsive||null;if(typeof l=="object"&&l!==null&&l.length){for(h in l)if(d=i.breakpoints.length-1,p=l[h].breakpoint,l.hasOwnProperty(h)){for(;d>=0;)i.breakpoints[d]&&i.breakpoints[d]===p&&i.breakpoints.splice(d,1),d--;i.breakpoints.push(p),i.breakpointSettings[p]=l[h].options}i.breakpoints.sort(function(y,g){return g-y})}},k.prototype._checkResponsive=function(){var i=this,h,p=!1,d=m.innerWidth;if(i.options.responsive&&i.options.responsive.length&&i.options.responsive!==null){p=null;for(h in i.breakpoints)i.breakpoints.hasOwnProperty(h)&&d<=i.breakpoints[h]&&(p=i.breakpoints[h]);p!==null?(i.activeBreakpoint=p,i.options=i._extend(i.options,i.breakpointSettings[p])):i.activeBreakpoint!==null&&(i.activeBreakpoint=null,p=null,i.options=i._extend(i.options,i.originalSettings))}},k.prototype._refresh=function(){var i=this;i._initializeStorage(),i._draw()},k.prototype._resize=function(){var i=this;i.element.width=i.element.offsetParent?i.element.offsetParent.clientWidth*i.ratio:i.element.clientWidth*i.ratio,i.element.offsetParent&&i.element.offsetParent.nodeName==="BODY"?i.element.height=m.innerHeight*i.ratio:i.element.height=i.element.offsetParent?i.element.offsetParent.clientHeight*i.ratio:i.element.clientHeight*i.ratio,i.context.scale(i.ratio,i.ratio),clearTimeout(i.windowDelay),i.windowDelay=m.setTimeout(function(){i._checkResponsive(),i._refresh()},50)},k.prototype._animate=function(){var i=this;i._draw(),i._animation=m.requestAnimFrame(i._animate)},k.prototype.resumeAnimation=function(){var i=this;i._animation||i._animate()},k.prototype.pauseAnimation=function(){var i=this;if(i._animation){if(i.usingPolyfill)m.clearTimeout(i._animation);else{var h=m.cancelAnimationFrame||m.webkitCancelAnimationFrame||m.mozCancelAnimationFrame;h(i._animation)}i._animation=null}},k.prototype._draw=function(){var i=this,h=i.element,p=h.offsetParent?h.offsetParent.clientWidth:h.clientWidth,d=h.offsetParent?h.offsetParent.clientHeight:h.clientHeight,l=i.options.showParticles,y=i.storage;h.offsetParent&&h.offsetParent.nodeName==="BODY"&&(d=m.innerHeight),i.context.clearRect(0,0,h.width,h.height),i.context.beginPath();for(var g=y.length;g--;){var G=y[g];l&&G._draw(),G._updateCoordinates(p,d)}i.options.connectParticles&&(y.sort(N),i._updateEdges())},k.prototype._updateEdges=function(){for(var i=this,h=i.options.minDistance,p=Math.sqrt,d=Math.abs,l=i.storage,y=l.length,g=0;g<y;g++)for(var G=l[g],I=g+1;I<y;I++){var B=l[I],f,S=G.x-B.x,C=G.y-B.y;if(f=p(S*S+C*C),d(S)>h)break;f<=h&&i._drawEdge(G,B,1.2-f/h)}},k.prototype._drawEdge=function(i,h,p){var d=this,l=d.context.createLinearGradient(i.x,i.y,h.x,h.y),y=this._hex2rgb(i.color),g=this._hex2rgb(h.color);l.addColorStop(0,"rgba("+y.r+","+y.g+","+y.b+","+p+")"),l.addColorStop(1,"rgba("+g.r+","+g.g+","+g.b+","+p+")"),d.context.beginPath(),d.context.strokeStyle=l,d.context.moveTo(i.x,i.y),d.context.lineTo(h.x,h.y),d.context.stroke(),d.context.fill(),d.context.closePath()},k.prototype._extend=function(i,h){return Object.keys(h).forEach(function(p){i[p]=h[p]}),i},k.prototype._hex2rgb=function(i){var h=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);return h?{r:parseInt(h[1],16),g:parseInt(h[2],16),b:parseInt(h[3],16)}:null},R=function(i,h){var p=this,d=Math.random,l=h.speed,y=h.color instanceof Array?h.color[Math.floor(Math.random()*h.color.length)]:h.color;p.context=i,p.options=h;var g=D.querySelector(h.selector);p.x=g.offsetParent?d()*g.offsetParent.clientWidth:d()*g.clientWidth,g.offsetParent&&g.offsetParent.nodeName==="BODY"?p.y=d()*m.innerHeight:p.y=g.offsetParent?d()*g.offsetParent.clientHeight:d()*g.clientHeight,p.vx=d()*l*2-l,p.vy=d()*l*2-l,p.radius=d()*d()*h.sizeVariations,p.color=y,p._draw()},R.prototype._draw=function(){var i=this;i.context.save(),i.context.translate(i.x,i.y),i.context.moveTo(0,0),i.context.beginPath(),i.context.arc(0,0,i.radius,0,Math.PI*2,!1),i.context.fillStyle=i.color,i.context.fill(),i.context.restore()},R.prototype._updateCoordinates=function(i,h){var p=this,d=p.x+this.vx,l=p.y+this.vy,y=p.radius;d+y>i?d=y:d-y<0&&(d=i-y),l+y>h?l=y:l-y<0&&(l=h-y),p.x=d,p.y=l},m.requestAnimFrame=function(){var i=this,h=m.requestAnimationFrame||m.webkitRequestAnimationFrame||m.mozRequestAnimationFrame;return h||(i._usingPolyfill=!0,function(p){return m.setTimeout(p,1e3/60)})}(),new k})(window,document)}const T=m=>(K("data-v-393efc10"),m=m(),Q(),m),ie=T(()=>L("div",{id:"particles-js"},null,-1)),se={class:"back_to_home"},ne=T(()=>L("img",{src:z,alt:"LOGO SVG"},null,-1)),oe=T(()=>L("h5",null,"回首頁",-1)),he=$('<div class="puzzle_frame" data-v-393efc10></div><div id="forPuzzle" data-v-393efc10></div><button class="open-lightbox" style="display:none;" data-v-393efc10>獲得折價券</button><div class="lightbox_out" data-v-393efc10><div class="lightbox" data-v-393efc10><div class="lightbox-content" data-v-393efc10><span class="close" data-v-393efc10>×</span><img src="'+W+'" alt="Image" data-v-393efc10><h2 data-v-393efc10>完成挑戰！</h2><div class="puzzle_line" data-v-393efc10></div><p data-v-393efc10>恭喜獲得商城購物折價券300元！<br data-v-393efc10> 結帳時，點選使用即可享有優惠 </p><div class="puzzle_coupon" data-v-393efc10><div class="puzzle_number" data-v-393efc10>TAIPEI2023</div><button class="save_coupon" data-v-393efc10><a href="#" data-v-393efc10>儲存折價券</a></button></div></div></div></div>',4),ae={__name:"GamePuzzle",setup(m){return Y(()=>{te(),ee()}),(D,k)=>{const R=X("RouterLink");return U(),V(J,null,[ie,L("button",se,[ne,Z(R,{to:"/"},{default:j(()=>[oe]),_:1})]),he],64)}}},ce=H(ae,[["__scopeId","data-v-393efc10"]]);export{ce as default};
